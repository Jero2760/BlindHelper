function getQueryString(){var e={};return location.search&&location.search.substr(1).replace(/\+/g,"%20").split("&").forEach(function(n){var t=n.split("=");e[decodeURIComponent(t[0])]=t[1]&&decodeURIComponent(t[1])}),e}function getSettings(e){return new Promise(function(n){brapi.storage.local.get(e||["voiceName","rate","pitch","volume","showHighlighting","languages"],n)})}function updateSettings(e){return new Promise(function(n){brapi.storage.local.set(e,n)})}function clearSettings(e){return new Promise(function(n){brapi.storage.local.remove(e||["voiceName","rate","pitch","volume","showHighlighting","languages"],n)})}function getState(e){return new Promise(function(n){brapi.storage.local.get(e,function(t){n(t[e])})})}function setState(e,n){var t={};return t[e]=n,new Promise(function(e){brapi.storage.local.set(t,e)})}function getVoices(){return browserTtsEngine.getVoices().then(function(e){var n=remoteTtsEngine.getVoices();return e.some(function(e){return e.voiceName==n[0].voiceName})||(e=e.concat(n)),e})}function isGoogleNative(e){return/^Google\s/.test(e)}function isGoogleTranslate(e){return/^GoogleTranslate /.test(e)}function isAmazonPolly(e){return/^Amazon /.test(e)}function isMicrosoftCloud(e){return/^Microsoft /.test(e)&&-1==e.indexOf(" - ")}function isRemoteVoice(e){return remoteTtsEngine.hasVoice(e)}function isPremiumVoice(e){return isAmazonPolly(e)||isMicrosoftCloud(e)}function executeFile(e){return new Promise(function(n,t){brapi.tabs.executeScript({file:e},function(e){brapi.runtime.lastError?t(new Error(brapi.runtime.lastError.message)):n(e)})})}function executeScript(e){return new Promise(function(n,t){brapi.tabs.executeScript({code:e},function(e){brapi.runtime.lastError?t(new Error(brapi.runtime.lastError.message)):n(e)})})}function insertCSS(e){return new Promise(function(n,t){brapi.tabs.insertCSS({file:e},function(e){brapi.runtime.lastError?t(new Error(brapi.runtime.lastError.message)):n(e)})})}function getBackgroundPage(){return new Promise(function(e){brapi.runtime.getBackgroundPage(e)})}function spread(e,n){return function(t){return e.apply(n,t)}}function extraAction(e){return function(n){return Promise.resolve(e(n)).then(function(){return n})}}function inSequence(e){return e.reduce(function(e,n){return e.then(n)},Promise.resolve())}function callMethod(e,n){return function(t){return t[e].apply(t,n)}}function waitMillis(e){return new Promise(function(n){setTimeout(n,e)})}function parseLang(e){var n=e.toLowerCase().replace(/_/g,"-").split(/-/,2);return{lang:n[0],rest:n[1]}}function formatError(e){var n=brapi.i18n.getMessage(e.code);return n&&(n=n.replace(/{(\w+)}/g,function(n,t){return e[t]})),n}function urlEncode(e){if(null==e)return null;var n=[];for(var t in e)n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n.join("&")}function ajaxGet(e){return new Promise(ajaxGetCb.bind(null,e))}function ajaxGetCb(e,n,t){var r=new XMLHttpRequest;r.open("GET",e,!0),r.onreadystatechange=function(){r.readyState==XMLHttpRequest.DONE&&(200==r.status?n(r.responseText):t&&t(new Error(r.responseText)))},r.send(null)}function ajaxPost(e,n,t){return new Promise(function(r,a){var o=new XMLHttpRequest;o.open("POST",e,!0),o.setRequestHeader("Content-type","json"==t?"application/json":"application/x-www-form-urlencoded"),o.onreadystatechange=function(){o.readyState==XMLHttpRequest.DONE&&(200==o.status?r(o.responseText):a(new Error(o.responseText)))},o.send("json"==t?JSON.stringify(n):urlEncode(n))})}function objectAssign(e,n){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1;r<arguments.length;r++){var a=arguments[r];if(null!=a)for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(t[o]=a[o])}return t}function domReady(){return new Promise(function(e){$(e)})}function setI18nText(){$("[data-i18n]").each(function(){var e=$(this).data("i18n"),n=brapi.i18n.getMessage(e);$(this).is("input")?$(this).val(n):$(this).text(n)})}function escapeHtml(e){return e.replace(/[&<>"'`=\/]/g,function(e){return config.entityMap[e]})}function getBrowser(){return/Opera|OPR\//.test(navigator.userAgent)?"opera":/firefox/i.test(navigator.userAgent)?"firefox":"chrome"}function getHotkeySettingsUrl(){switch(getBrowser()){case"opera":return"opera://settings/configureCommands";case"chrome":return"chrome://extensions/configureCommands";default:return brapi.runtime.getURL("shortcuts.html")}}function BrowserTtsEngine(){this.speak=function(e,n,t){brapi.tts.speak(e,{voiceName:n.voice.voiceName,lang:n.lang,rate:n.rate,pitch:n.pitch,volume:n.volume,requiredEventTypes:["start","end"],desiredEventTypes:["start","end","error"],onEvent:t})},this.stop=brapi.tts.stop,this.pause=brapi.tts.pause,this.resume=brapi.tts.resume,this.isSpeaking=brapi.tts.isSpeaking,this.getVoices=function(){return new Promise(function(e){brapi.tts.getVoices(e)})}}function WebSpeechEngine(){var e;this.speak=function(n,t,r){e=new SpeechSynthesisUtterance,e.text=n,e.voice=t.voice,t.lang&&(e.lang=t.lang),t.pitch&&(e.pitch=t.pitch),t.rate&&(e.rate=t.rate),t.volume&&(e.volume=t.volume),e.onstart=r.bind(null,{type:"start",charIndex:0}),e.onend=r.bind(null,{type:"end",charIndex:n.length}),e.onerror=function(e){r({type:"error",errorMessage:e.error})},speechSynthesis.speak(e)},this.stop=function(){e&&(e.onend=null),speechSynthesis.cancel()},this.pause=function(){speechSynthesis.pause()},this.resume=function(){speechSynthesis.resume()},this.isSpeaking=function(e){e(speechSynthesis.speaking)},this.getVoices=function(){return new Promise(function(e){var n=speechSynthesis.getVoices();n.length?e(n):speechSynthesis.onvoiceschanged=function(){e(speechSynthesis.getVoices())}}).then(function(e){for(var n=0;n<e.length;n++)e[n].voiceName=e[n].name;return e})}}function DummyTtsEngine(){this.getVoices=function(){return Promise.resolve([])}}function RemoteTtsEngine(e,n){function t(n,t,r){return e+"/read-aloud/speak/"+t+"/"+encodeURIComponent(r)+"?q="+encodeURIComponent(n)}for(var r,a=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform),o=document.createElement("AUDIO"),s=document.createElement("AUDIO"),i=!1,c=0,l=n.tts_engine.voices.map(function(e){return{voiceName:e.voice_name,lang:e.lang}}),u={},g=0;g<l.length;g++)u[l[g].voiceName]=l[g];this.speak=function(e,n,s){n.volume||(n.volume=1),n.rate||(n.rate=1),o.pause(),a||(o.volume=n.volume,o.defaultPlaybackRate=n.rate),o.src=t(e,n.lang,n.voice.voiceName),o.oncanplay=function(){var e=c-(new Date).getTime();e>0?r=setTimeout(o.play.bind(o),e):o.play(),i=!0},o.onplay=s.bind(null,{type:"start",charIndex:0}),o.onended=function(){s({type:"end",charIndex:e.length}),i=!1},o.onerror=function(){s({type:"error",errorMessage:o.error.message}),i=!1},o.load()},this.isSpeaking=function(e){e(i)},this.pause=this.stop=function(){clearTimeout(r),o.pause()},this.resume=function(){o.play()},this.prefetch=function(e,n){a||(s.src=t(e,n.lang,n.voice.voiceName),s.load())},this.setNextStartTime=function(e,n){a||(c=e||0)},this.getVoices=function(){return l},this.hasVoice=function(e){return null!=u[e]}}function Speech(e,n){function t(){return new Promise(function(e){_.isSpeaking(function(n){e("PLAYING"==b?n?"PLAYING":"LOADING":"PAUSED")})})}function r(){return{index:S,texts:e}}function a(){return S>=e.length?(b="IDLE",n.onEnd&&n.onEnd(),Promise.resolve()):"PAUSED"==b?(b="PLAYING",_.resume(),Promise.resolve()):(b=new String("PLAYING"),b.startTime=(new Date).getTime(),g(e[S],function(){b="IDLE",_.setNextStartTime&&_.setNextStartTime((new Date).getTime()+w,n),S++,a()},function(e){b="IDLE",n.onEnd&&n.onEnd(e)}).then(function(){e[S+1]&&_.prefetch&&_.prefetch(e[S+1],n)}))}function o(){return clearTimeout(y),y=setTimeout(a,750),Promise.resolve()}function s(){return _.pause?(_.pause(),b="PAUSED",Promise.resolve()):i()}function i(){return _.stop(),b="IDLE",Promise.resolve()}function c(){return S+1<e.length?(S++,o()):Promise.reject(new Error("Can't forward, at end"))}function l(){return"PLAYING"==b&&(new Date).getTime()-b.startTime>3e3?a():S>0?(S--,a()):Promise.reject(new Error("Can't rewind, at beginning"))}function u(){S=e.length&&e.length-1}function g(e,t,r){return new Promise(function(a){_.speak(e,n,function(e){"start"==e.type?a():"end"==e.type?t():"error"==e.type&&r(new Error(e.errorMessage||"Unknown TTS error"))})})}function d(e,n){function t(e){return s(n.getParagraphs(e),r)}function r(e){return s(n.getSentences(e),a)}function a(e){return s(n.getPhrases(e),o)}function o(t){for(var r=n.getWords(t),a=Math.min(Math.ceil(r.length/2),e),o=[];r.length;)o.push(r.slice(0,a).join("")),r=r.slice(a);return o}function s(t,r){var a=[],o={parts:[],wordCount:0},s=function(){o.parts.length&&(a.push(o.parts.join("")),o={parts:[],wordCount:0})};return t.forEach(function(t){var i=n.getWords(t).length;if(i>e){s();for(var c=r(t),l=0;l<c.length;l++)a.push(c[l])}else o.wordCount+i>e&&s(),o.parts.push(t),o.wordCount+=i}),s(),a}this.breakText=t}function p(e,n,t){function r(e){return c(n.getParagraphs(e),a,t)}function a(e){return c(n.getSentences(e),o)}function o(e){return c(n.getPhrases(e),s)}function s(e){return c(n.getWords(e),i)}function i(n){for(var t=[];n;)t.push(n.slice(0,e)),n=n.slice(e);return t}function c(n,t,r){var a=[],o={parts:[],charCount:0},s=function(){o.parts.length&&(a.push(o.parts.join("")),o={parts:[],charCount:0})};return n.forEach(function(n){var i=n.length;if(i>e){s();for(var c=t(n),l=0;l<c.length;l++)a.push(c[l])}else o.charCount+i>(r||e)&&s(),o.parts.push(n),o.charCount+=i}),s(),a}this.breakText=r}function m(){function e(e){for(var n=[],t=0;t<e.length;t+=2)t+1<e.length?n.push(e[t]+e[t+1]):e[t]&&n.push(e[t]);return n}this.getParagraphs=function(n){return e(n.split(/((?:\r?\n\s*){2,})/))},this.getSentences=function(n){return e(n.split(/([.!?]+[\s\u200b]+)/))},this.getPhrases=function(n){return e(n.split(/([,;:]\s+|\s-+\s+|—\s*)/))},this.getWords=function(e){for(var n=e.trim().split(/([~@#%^*_+=<>]|[\s\-—\/]+|\.(?=\w{2,})|,(?=[0-9]))/),t=[],r=0;r<n.length;r+=2)n[r]&&t.push(n[r]),r+1<n.length&&(/^[~@#%^*_+=<>]$/.test(n[r+1])?t.push(n[r+1]):t.length&&(t[t.length-1]+=n[r+1]));return t}}function f(){function e(e){for(var n=[],t=0;t<e.length;t+=2)t+1<e.length?n.push(e[t]+e[t+1]):e[t]&&n.push(e[t]);return n}this.getParagraphs=function(n){return e(n.split(/((?:\r?\n\s*){2,})/))},this.getSentences=function(n){return e(n.split(/([.!?]+[\s\u200b]+|[\u3002\uff01]+)/))},this.getPhrases=function(n){return e(n.split(/([,;:]\s+|[\u2025\u2026\u3000\u3001\uff0c\uff1b]+)/))},this.getWords=function(e){return e.replace(/\s+/g,"").split("")}}function h(e,n){var t;this.speak=function(r,a,o){clearTimeout(t),t=setTimeout(function(){e.stop(),o({type:"end",charIndex:r.length})},n),e.speak(r,a,function(e){"end"!=e.type&&"error"!=e.type||clearTimeout(t),o(e)})},this.stop=function(){clearTimeout(t),e.stop()},this.isSpeaking=e.isSpeaking}n.rate=(n.rate||1)*(isGoogleNative(n.voice.voiceName)?.9:isGoogleTranslate(n.voice.voiceName)?1.1:1);for(var v=0;v<e.length;v++)/\w$/.test(e[v])&&(e[v]+=".");e.length&&(e=function(e){var t=/^zh|ko|ja/.test(n.lang),r=t?new f:new m;if(isGoogleNative(n.voice.voiceName)){return new d((/^(de|ru)/.test(n.lang)?32:36)*(t?2:1)*n.rate,r).breakText(e)}return isGoogleTranslate(n.voice.voiceName)?new p(200,r).breakText(e):new p(500,r,200).breakText(e)}(e.join("\n\n")));var y,_=n.engine||function(){return isRemoteVoice(n.voice.voiceName)?remoteTtsEngine:isGoogleNative(n.voice.voiceName)?new h(browserTtsEngine,16e3):browserTtsEngine}(),w=isGoogleTranslate(n.voice.voiceName)?0:650/n.rate,b="IDLE",S=0;this.options=n,this.play=a,this.pause=s,this.stop=i,this.getState=t,this.getPosition=r,this.forward=c,this.rewind=l,this.gotoEnd=u}function addToContent(e){var n=document.getElementsByTagName(e).length;content=[];for(var t=0;t<n;t++)content.push(document.getElementsByTagName(e)[t].innerHTML);return content}function addToContentWithClass(e){for(var n=document.getElementsByClassName(e).length,t=[],r=0;r<n;r++)t.push(document.getElementsByClassName(e)[r].innerHTML);return t}function addToContent(e){var n=document.getElementsByTagName(e).length;content=[];for(var t=0;t<n;t++)content.push(document.getElementsByTagName(e)[t].innerHTML);return content}function addToContentWithClass(e){for(var n=document.getElementsByClassName(e).length,t=[],r=0;r<n;r++)t.push(document.getElementsByClassName(e)[r].innerHTML);return t}function getSpeech(e){return getSettings().then(function(n){var t={rate:n.rate||defaults.rate,pitch:n.pitch||defaults.pitch,volume:n.volume||defaults.volume,lang:"en"};return getSpeechVoice(n.voiceName,t.lang).then(function(n){if(!n)throw new Error(JSON.stringify({code:"error_no_voice",lang:t.lang}));return t.voice=n,new Speech(e,t)})})}function getSpeechVoice(e,n){return getVoices().then(function(t){return e?findVoiceByName(t,e):n?findVoiceByLang(t.filter(function(e){return isGoogleNative(e.voiceName)}),n)||findVoiceByLang(t.filter(function(e){return!isRemoteVoice(e.voiceName)}),n)||findVoiceByLang(t.filter(function(e){return!isPremiumVoice(e.voiceName)}),n)||findVoiceByLang(t,n):null})}function findVoiceByName(e,n){for(var t=0;t<e.length;t++)if(e[t].voiceName==n)return e[t];return null}function findVoiceByLang(e,n){var t=parseLang(n),r={};return e.forEach(function(e){if(e.lang){var n=parseLang(e.lang);n.lang==t.lang&&(n.rest==t.rest?"female"==e.gender?r.first=r.first||e:r.second=r.second||e:n.rest?"en"==n.lang&&"us"==n.rest?r.fourth=e:r.fourth=r.fourth||e:r.third=r.third||e)}}),r.first||r.second||r.third||r.fourth}function speechWrapper(e){return getSpeech(e).then(function(e){return console.log(e),e.play()})}function updateButtons(){return getBackgroundPage().then(function(e){return Promise.all([getSettings(),e.getPlaybackState(),e.getActiveSpeech()])}).then(spread(function(e,n,t){if($("#imgLoading").toggle("LOADING"==n),$("#btnSettings").toggle("STOPPED"==n),$("#btnPlay").toggle("PAUSED"==n||"STOPPED"==n),$("#btnPause").toggle("PLAYING"==n),$("#btnStop").toggle("PAUSED"==n||"PLAYING"==n||"LOADING"==n),$("#btnForward, #btnRewind").toggle("PLAYING"==n),$("#attribution").toggle(Boolean(t&&isGoogleTranslate(t.options.voice.voiceName))),$("#highlight, #resize").toggle(Boolean(null!=e.showHighlighting?e.showHighlighting:defaults.showHighlighting)&&("PAUSED"==n||"PLAYING"==n)),e.showHighlighting&&t){var r=t.getPosition(),a=$("#highlight");if(a.data("texts")!=r.texts){a.data({texts:r.texts,index:-1}),a.empty();for(var o=0;o<r.texts.length;o++){var s=escapeHtml(r.texts[o]).replace(/\r?\n/g,"<br/>");$("<span>").html(s).appendTo(a)}}if(a.data("index")!=r.index){a.data("index",r.index),a.children(".active").removeClass("active");var i=a.children().eq(r.index).addClass("active");if(i.length){var c=i.position().top,l=c+i.outerHeight();(c<0||l>=a.height())&&a.animate({scrollTop:a[0].scrollTop+c-10})}}}}))}var readAloudManifest={manifest_version:2,name:"__MSG_extension_name__",short_name:"__MSG_extension_short_name__",description:"__MSG_extension_description__",version:"1.3.3",default_locale:"en",browser_action:{default_icon:"img/icon.png",default_popup:"popup.html"},icons:{16:"img/icon-16.png",48:"img/icon-48.png",128:"img/icon.png"},permissions:["activeTab","tabs","tts","storage","ttsEngine","contextMenus","https://support.lsdsoftware.com/"],content_security_policy:"script-src 'self'; object-src 'self'",web_accessible_resources:[],background:{scripts:["js/es6-promise.auto.min.js","js/defaults.js","js/speech.js","js/document.js","js/events.js","js/stt.js","js/scan.js","js/listen.js"],persistent:!1},options_page:"options.html",options_ui:{page:"options.html",chrome_style:!0},commands:{play:{suggested_key:{default:"Alt+P"},description:"play/pause"},stop:{suggested_key:{default:"Alt+O"},description:"stop"},forward:{suggested_key:{default:"Alt+Period"},description:"forward"},rewind:{suggested_key:{default:"Alt+Comma"},description:"rewind"}},tts_engine:{voices:[{voice_name:"GoogleTranslate Afrikaans",lang:"af",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Albanian",lang:"sq",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Arabic",lang:"ar",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Armenian",lang:"hy",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Bengali",lang:"bn",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Bosnian",lang:"bs",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Catalan",lang:"ca",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Chinese",lang:"zh-CN",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Croatian",lang:"hr",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Czech",lang:"cs",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Danish",lang:"da",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Dutch",lang:"nl",event_types:["start","end","error"]},{voice_name:"GoogleTranslate English",lang:"en",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Esperanto",lang:"eo",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Finnish",lang:"fi",event_types:["start","end","error"]},{voice_name:"GoogleTranslate French",lang:"fr",event_types:["start","end","error"]},{voice_name:"GoogleTranslate German",lang:"de",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Greek",lang:"el",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Hebrew",lang:"he",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Hindi",lang:"hi",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Hungarian",lang:"hu",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Icelandic",lang:"is",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Indonesian",lang:"id",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Italian",lang:"it",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Japanese",lang:"ja",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Khmer",lang:"km",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Korean",lang:"ko",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Latin",lang:"la",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Latvian",lang:"lv",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Macedonian",lang:"mk",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Nepali",lang:"ne",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Norwegian",lang:"no",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Polish",lang:"pl",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Portuguese",lang:"pt",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Romanian",lang:"ro",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Russian",lang:"ru",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Serbian",lang:"sr",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Sinhala",lang:"si",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Slovak",lang:"sk",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Spanish",lang:"es",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Swahili",lang:"sw",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Swedish",lang:"sv",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Tamil",lang:"ta",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Thai",lang:"th",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Turkish",lang:"tr",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Ukrainian",lang:"uk",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Vietnamese",lang:"vi",event_types:["start","end","error"]},{voice_name:"GoogleTranslate Welsh",lang:"cy",event_types:["start","end","error"]},{voice_name:"Amazon Australian English (Nicole)",lang:"en-AU",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Australian English (Russell)",lang:"en-AU",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Brazilian Portuguese (Ricardo)",lang:"pt-BR",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Brazilian Portuguese (Vitoria)",lang:"pt-BR",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon British English (Amy)",lang:"en-GB",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon British English (Brian)",lang:"en-GB",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon British English (Emma)",lang:"en-GB",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Canadian French (Chantal)",lang:"fr-CA",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Castilian Spanish (Conchita)",lang:"es-ES",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Castilian Spanish (Enrique)",lang:"es-ES",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Danish (Mads)",lang:"da-DK",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Danish (Naja)",lang:"da-DK",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Dutch (Lotte)",lang:"nl-NL",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Dutch (Ruben)",lang:"nl-NL",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon French (Celine)",lang:"fr-FR",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon French (Mathieu)",lang:"fr-FR",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon German (Hans)",lang:"de-DE",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon German (Marlene)",lang:"de-DE",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon German (Vicki)",lang:"de-DE",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Icelandic (Dora)",lang:"is-IS",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Icelandic (Karl)",lang:"is-IS",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Indian English (Aditi)",lang:"en-IN",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Indian English (Raveena)",lang:"en-IN",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Italian (Carla)",lang:"it-IT",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Italian (Giorgio)",lang:"it-IT",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Japanese (Mizuki)",lang:"ja-JP",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Japanese (Takumi)",lang:"ja-JP",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Korean (Seoyeon)",lang:"ko-KR",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Norwegian (Liv)",lang:"nb-NO",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Polish (Ewa)",lang:"pl-PL",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Polish (Jacek)",lang:"pl-PL",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Polish (Jan)",lang:"pl-PL",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Polish (Maja)",lang:"pl-PL",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Portuguese (Cristiano)",lang:"pt-PT",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Portuguese (Ines)",lang:"pt-PT",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Romanian (Carmen)",lang:"ro-RO",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Russian (Maxim)",lang:"ru-RU",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon Russian (Tatyana)",lang:"ru-RU",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Swedish (Astrid)",lang:"sv-SE",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Turkish (Filiz)",lang:"tr-TR",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon US English (Ivy)",lang:"en-US",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon US English (Joanna)",lang:"en-US",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon US English (Joey)",lang:"en-US",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon US English (Justin)",lang:"en-US",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon US English (Kendra)",lang:"en-US",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon US English (Kimberly)",lang:"en-US",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon US English (Matthew)",lang:"en-US",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon US English (Salli)",lang:"en-US",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon US Spanish (Miguel)",lang:"es-US",gender:"male",event_types:["start","end","error"]},{voice_name:"Amazon US Spanish (Penelope)",lang:"es-US",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Welsh (Gwyneth)",lang:"cy-GB",gender:"female",event_types:["start","end","error"]},{voice_name:"Amazon Welsh English (Geraint)",lang:"en-GB-WLS",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Australian English (Catherine)",lang:"en-AU",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Australian English (James)",lang:"en-AU",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Belgian Dutch (Bart)",lang:"nl-BE",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Brazilian Portuguese (Daniel)",lang:"pt-BR",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Brazilian Portuguese (Maria)",lang:"pt-BR",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft British English (George)",lang:"en-GB",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft British English (Hazel)",lang:"en-GB",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft British English (Susan)",lang:"en-GB",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Canadian English (Linda)",lang:"en-CA",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Canadian English (Richard)",lang:"en-CA",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Canadian French (Caroline)",lang:"fr-CA",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Canadian French (Claude)",lang:"fr-CA",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Canadian French (Nathalie)",lang:"fr-CA",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Catalan (Herena)",lang:"ca-ES",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Chinese (Huihui)",lang:"zh-CN",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Chinese (Kangkang)",lang:"zh-CN",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Chinese (Yaoyao)",lang:"zh-CN",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft ChineseTW (Hanhan)",lang:"zh-TW",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft ChineseTW (Yating)",lang:"zh-TW",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft ChineseTW (Zhiwei)",lang:"zh-TW",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Danish (Helle)",lang:"da-DK",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Dutch (Frank)",lang:"nl-NL",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Finnish (Heidi)",lang:"fi-FI",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft French (Hortense)",lang:"fr-FR",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft French (Julie)",lang:"fr-FR",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft French (Paul)",lang:"fr-FR",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft German (Hedda)",lang:"de-DE",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft German (Katja)",lang:"de-DE",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft German (Stefan)",lang:"de-DE",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Indian English (Heera)",lang:"en-IN",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Indian English (Ravi)",lang:"en-IN",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Italian (Cosimo)",lang:"it-IT",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Italian (Elsa)",lang:"it-IT",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Japanese (Ayumi)",lang:"ja-JP",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Japanese (Haruka)",lang:"ja-JP",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Japanese (Ichiro)",lang:"ja-JP",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Japanese (Sayaka)",lang:"ja-JP",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Korean (Heami)",lang:"ko-KR",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Mexican Spanish (Raul)",lang:"es-MX",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Mexican Spanish (Sabina)",lang:"es-MX",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Norwegian (Jon)",lang:"nb-NO",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Polish (Adam)",lang:"pl-PL",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Polish (Paulina)",lang:"pl-PL",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Portuguese (Helia)",lang:"pt-PT",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Russian (Irina)",lang:"ru-RU",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Russian (Pavel)",lang:"ru-RU",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Spanish (Helena)",lang:"es-ES",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Spanish (Laura)",lang:"es-ES",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Spanish (Pablo)",lang:"es-ES",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Swedish (Bengt)",lang:"sv-SE",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft Turkish (Tolga)",lang:"tr-TR",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft US English (David)",lang:"en-US",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft US English (Mark)",lang:"en-US",gender:"male",event_types:["start","end","error"]},{voice_name:"Microsoft US English (Zira)",lang:"en-US",gender:"female",event_types:["start","end","error"]},{voice_name:"Microsoft Vietnamese (An)",lang:"vi-VI",gender:"male",event_types:["start","end","error"]}]}},brapi="undefined"!=typeof chrome?chrome:"undefined"!=typeof browser?browser:{},config={serviceUrl:"https://support.lsdsoftware.com",entityMap:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"}},defaults={rate:1,pitch:1,volume:1,showHighlighting:0},browserTtsEngine=brapi.tts?new BrowserTtsEngine:"undefined"!=typeof speechSynthesis?new WebSpeechEngine:new DummyTtsEngine,remoteTtsEngine=new RemoteTtsEngine(config.serviceUrl,void 0!==readAloudManifest?readAloudManifest:brapi.runtime.getManifest())
;"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:objectAssign,writable:!0,configurable:!0}),String.prototype.startsWith||(String.prototype.startsWith=function(e,n){return this.substr(!n||n<0?0:+n,e.length)===e}),function(){function e(e){window.docReady||(window.docReady=t()),window.docReady.then(function(t){n(e,t)})}function n(e,n){function t(e,n){var t=n.request;if(e[t.method]){var r=e[t.method](t);Promise.resolve(r).then(function(e){c.postMessage({id:n.id,response:e})})}}function r(e){var t=document.documentElement.lang||$("html").attr("xml:lang");return t&&(t=t.split(",",1)[0].replace(/_/g,"-")),"en"!=t&&"en-US"!=t||(t=null),{url:location.href,title:document.title,lang:t,requireJs:n.requireJs}}function a(e){return s()?-100:n.getCurrentIndex()}function o(e){return e.index<0?-100==e.index?s().split(h):null:Promise.resolve(n.getTexts(e.index,e.quietly)).then(function(n){return n&&(n=n.map(i),e.quietly||console.log(n.join("\n\n"))),n})}function s(){return window.getSelection().toString().trim()}function i(e){return e.replace(/https?:\/\/\S+/g,"this URL.")}var c=f.runtime.connect({name:e});c.onMessage.addListener(t.bind(null,{raGetInfo:r,raGetCurrentIndex:a,raGetTexts:o}))}function t(){function e(){return"docs.google.com"==location.hostname?$(".kix-appview-editor").length?new r:$(".drive-viewer-paginated-scrollable").length?new a:new c:"drive.google.com"==location.hostname?new a:/^read\.amazon\./.test(location.hostname)?new o:"www.khanacademy.org"==location.hostname?new i:location.pathname.match(/\.pdf$/)?new s(location.href):$("embed[type='application/pdf']").length?new s($("embed[type='application/pdf']").attr("src")):new c}return function(){return new Promise(function(e){$(e)})}().then(e).then(function(e){return Promise.resolve(e.ready).then(function(){return e})})}function r(){function e(){return $(".kix-paragraphrenderer",this).get().map(l).filter(u)}function n(){var e=googleDocsUtil.getGoogleDocument();return t||(t={caret:e.caret.index,prev:[],text:e.selectedText}),t.caret!=e.caret.index&&(t.caret=e.caret.index,t.prev.push(t.text),t.text=e.selectedText,t.prev=t.prev.filter(function(e){var n=t.text.indexOf(e);return-1!=n&&(t.text=t.text.slice(0,n)+t.text.slice(n+e.length)),-1!=n})),t.text}var t,r=$(".kix-appview-editor").get(0),a=$(".kix-page");this.requireJs=["js/googleDocsUtil.js"],this.getCurrentIndex=function(){if(n())return 9999;for(var e=0;e<a.length&&!(a.eq(e).position().top>r.scrollTop+$(r).height()/2);e++);return e-1},this.getTexts=function(t,o){if(9999==t)return[n()];var s=a.get(t);if(s){var i=r.scrollTop;return r.scrollTop=$(s).position().top,d(e.bind(s),2e3).then(function(e){return o&&(r.scrollTop=i),e})}return null}}function a(){function e(){return g($("p",this).get().map(l).filter(u))}var n=$(".drive-viewer-paginated-scrollable").get(0),t=$(".drive-viewer-paginated-page");this.getCurrentIndex=function(){for(var e=0;e<t.length&&!(t.eq(e).position().top>n.scrollTop+$(n).height()/2);e++);return e-1},this.getTexts=function(r,a){var o=t.get(r);if(o){var s=n.scrollTop;return n.scrollTop=$(o).position().top,d(e.bind(o),3e3).then(function(e){return a&&(n.scrollTop=s),e})}return null}}function o(){function e(){var e=[];o.filter(function(e){return null!=e&&"hidden"!=e.style.visibility}).forEach(function(n){var t=$(n).height();$("h1, h2, h3, h4, h5, h6, .was-a-p",n.contentDocument).each(function(){var n=$(this).offset().top;$(this).height();n>=0&&n<t&&e.push($(this).text())})});for(var t=[],r=0;r<e.length;r++)e[r]!=(t.length?t[t.length-1]:n)&&t.push(e[r]);return n=t[t.length-1],t}var n,t=document.getElementById("KindleReaderIFrame").contentDocument,r=t.getElementById("kindleReader_pageTurnAreaRight"),a=t.getElementById("kindleReader_pageTurnAreaLeft"),o=[t.getElementById("column_0_frame_0"),t.getElementById("column_0_frame_1"),t.getElementById("column_1_frame_0"),t.getElementById("column_1_frame_1")],s=0;this.getCurrentIndex=function(){return s=0},this.getTexts=function(n){for(;s<n;s++)$(r).click();for(;s>n;s--)$(a).click();return d(e,4e3)}}function s(e){var n=new m("PdfDoc");this.ready=new Promise(function(t){n.once("pageScriptLoaded",function(){n.trigger("loadDocument",e)}),n.once("documentLoaded",t),p("https://assets.lsdsoftware.com/read-aloud/page-scripts/pdf-viewer.js")}),this.getCurrentIndex=function(){return new Promise(function(e){n.once("currentIndexGot",e).trigger("getCurrentIndex")})},this.getTexts=function(e,t){return new Promise(function(r){n.once("textsGot",r).trigger("getTexts",e,t)})}}function i(){function e(){return $("h1:first").add($("> :not(ul, ol), > ul > li, > ol > li",".paragraph:not(.paragraph .paragraph)")).get().map(function(e){var n=l(e);return $(e).is("li")?$(e).index()+1+". "+n:n})}this.getCurrentIndex=function(){return 0},this.getTexts=function(n){return 0==n?e():null}}function c(){function e(){var e=new Date,a=n(100),o=a.reduce(function(e,n){return e+l(n).length},0);if(console.log("Found",a.length,"blocks",o,"chars in",new Date-e,"ms"),o<1e3){a=n(3);var s=a.map(l);console.log("Using lower threshold, found",a.length,"blocks",s.join("").length,"chars");for(var i,g,d=3;d<s.length&&!i;d++){var p=t(s,0,d);s[d].length>p.mean+2*p.stdev&&(i=d)}for(var d=s.length-4;d>=0&&!g;d--){var p=t(s,d+1,s.length);s[d].length>p.mean+2*p.stdev&&(g=d+1)}(i||g)&&(a=a.slice(i||0,g),console.log("Trimmed",i,g))}for(var f=[],d=0;d<a.length;d++)f.push.apply(f,c(a[d],a[d-1])),f.push(a[d]);$(f).addClass("read-aloud");var s=f.map(r);return m(s).filter(u)}function n(e){var n="h1, h2, h3, h4, h5, h6, p, a[href], "+f,t=function(e){return 3==e.nodeType&&e.nodeValue.trim().length>=3},r=function(n){return 1==n.nodeType&&$(n).is("p")&&l(n).length>=e},a=function(n){return p(n,t)&&l(n).length>=e},o=function(e){return p(e,r)},s=function(e){var t=$(e).children(":not("+n+")").get();return t.some(a)||t.some(o)||t.some(s)},i=function(e,n){n&&$(e).data("read-aloud-multi-block",!0),u.push(e)},c=function(){if($(this).is("frame, iframe"))try{c.call(this.contentDocument.body)}catch(e){}else if($(this).is("dl"))i(this);else if($(this).is("ol, ul")){var e=$(this).children().get();e.some(a)?i(this):e.some(o)?i(this,!0):e.some(s)&&i(this,!0)}else if($(this).is("tbody")){var t=$(this).children();t.length>3||t.eq(0).children().length>3?t.get().some(s)&&i(this,!0):t.each(c)}else a(this)?i(this):o(this)?i(this,!0):$(this).children(":not("+n+")").each(c)},u=[];return c.call(document.body),u.filter(function(e){return $(e).is(":visible")&&$(e).offset().left>=0})}function t(e,n,t){void 0==n&&(n=0),void 0==t&&(t=e.length);for(var r=0,a=n;a<t;a++)r+=e[a].length;for(var o=r/(t-n),s=0,a=n;a<t;a++)s+=(e[a].length-o)*(e[a].length-o);return{mean:o,stdev:Math.sqrt(s)}}function r(e){var n=$(e).find(":visible").filter(o).hide();$(e).find("ol, ul").addBack("ol, ul").each(a);var t=$(e).data("read-aloud-multi-block")?$(e).children(":visible").get().map(s):s(e).split(h);return $(e).find(".read-aloud-numbering").remove(),n.show(),t}function a(){var e=$(this).children(),n=e.length?l(e.get(0)):null;n&&!n.match(/^[(]?(\d|[a-zA-Z][).])/)&&e.each(function(e){$("<span>").addClass("read-aloud-numbering").text(e+1+". ").prependTo(this)})}function o(){var e=$(this).css("float"),n=$(this).css("position");return $(this).is(f)||$(this).is("sup")||"right"==e||"fixed"==n}function s(e){return i(e.innerText).trim()}function i(e){return e.replace(/(\w)(\s*?\r?\n)/g,"$1.$2")}function c(e,n){for(var t=[],r=$(e).find("h1, h2, h3, h4, h5, h6, p").filter(":visible").get(0),a=g(r),o=d(e,!0);o&&o!=n;){var s=$(o).is(f);if(!s&&1==o.nodeType&&$(o).is(":visible")){var i=g(o);i<a&&(t.push(o),a=i)}o=d(o,s)}return t.reverse()}function g(e){var n=e&&/^H(\d)$/i.exec(e.tagName);return n?Number(n[1]):100}function d(e,n){return $(e).is("body")?null:1==e.nodeType&&!n&&e.lastChild?e.lastChild:e.previousSibling?e.previousSibling:d(e.parentNode,!0)}function p(e,n){for(var t=e.firstChild;t;){if(n(t))return!0;t=t.nextSibling}return!1}function m(e){return[].concat.apply([],e)}var f="select, textarea, button, label, audio, video, dialog, embed, menu, nav, noframes, noscript, object, script, style, svg, aside, footer, #footer, .no-read-aloud";this.getCurrentIndex=function(){return 0},this.getTexts=function(n){return 0==n?e():null}}function l(e){var n=e.innerText;return n?n.trim():""}function u(e){return e}function g(e){for(var n=[],t="",r=0;r<e.length;r++)e[r]?(t&&(/-$/.test(t)?t=t.substr(0,t.length-1):t+=" "),t+=e[r].replace(/-\r?\n/g,""),e[r].match(/[.!?:)"'\u2019\u201d]$/)&&(n.push(t),t="")):t&&(n.push(t),t="");return t&&n.push(t),n}function d(e,n){return function(e){return new Promise(function(n){setTimeout(n,e)})}(500).then(e).then(function(t){return t&&!t.length&&n-500>0?d(e,n-500):t})}function p(e){$("head").length||$("<head>").prependTo("html"),$.getScript(e)}function m(e){this.on=function(n,t){return document.addEventListener(e+n,function(e){t.apply(null,JSON.parse(e.detail))}),this},this.once=function(n,t){var r=function(a){document.removeEventListener(e+n,r),t.apply(null,JSON.parse(a.detail))};return document.addEventListener(e+n,r),this},this.trigger=function(n){var t=Array.prototype.slice.call(arguments,1);return document.dispatchEvent(new CustomEvent(e+n,{detail:JSON.stringify(t)})),this}}var f="undefined"!=typeof chrome?chrome:"undefined"!=typeof browser?browser:{},h=/(?:\s*\r?\n\s*){2,}/;$.ajaxSetup({cache:!0}),window.connect=e,window.HtmlDoc=c}();var readAloud=new function(){function ready(){return window.jQuery?(window.$?window.$!=window.jQuery&&console.warn("WARNING: TalkToMe embed script may not work because $ != jQuery."):window.$=window.jQuery,Promise.resolve()):ajaxGet("https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js").then(eval)}function speak(e,n){return voiceProvider.getVoice(n.lang).then(function(t){return t?(n.voice=t,n.onEnd=function(){speech=null,updateButtons()},speech&&speech.stop(),speech=new Speech(e,n),speech.play()):void alert("Language not supported '"+n.lang+"'")})}function updateButtons(){return isPlaying().then(function(e){$(".ra-play").toggle(!e),$(".ra-pause").toggle(e),attribution.toggle(e&&isGoogleTranslate(speech.options.voice.voiceName))})}function isPlaying(){return speech?speech.getState().then(function(e){return"PAUSED"!=e}):Promise.resolve(!1)}function VoiceProvider(){function e(e,n){var t=parseLang(n),r={};return e.forEach(function(e){if(e.lang){var n=parseLang(e.lang);n.lang==t.lang&&(n.rest==t.rest?"female"==e.gender?r.first=r.first||e:r.second=r.second||e:n.rest?"en"==n.lang&&"us"==n.rest?r.fourth=e:r.fourth=r.fourth||e:r.third=r.third||e)}}),r.first||r.second||r.third||r.fourth}this.getVoice=function(n){return getVoices().then(function(t){return e(t.filter(function(e){return!isRemoteVoice(e.voiceName)}),n)||e(t.filter(function(e){return isMicrosoftCloud(e.voiceName)}),n)||e(t,n)})}}function Attribution(){function e(){n=$("<div/>").appendTo(document.body),$("<div>powered&nbsp;by</div>").css({color:"#888","margin-bottom":"3px"}).appendTo(n),$("<span>G</span>").css("color","#4885ed").appendTo(n),$("<span>o</span>").css("color","#db3236").appendTo(n),$("<span>o</span>").css("color","#f4c20d").appendTo(n),$("<span>g</span>").css("color","#4885ed").appendTo(n),$("<span>l</span>").css("color","#3cba54").appendTo(n),$("<span>e</span>").css("color","#db3236").appendTo(n),$("<span>&nbsp;Translate</span>").css("color","#888").appendTo(n),n.css({display:"none",position:"absolute",padding:"6px",color:"black","background-color":"white","border-radius":"3px","box-shadow":"1px 1px 3px gray","font-family":"Arial, Helvetica, sans-serif","font-size":"small","text-align":"center",cursor:"pointer"}).click(function(){window.open("https://translate.google.com/","_blank")})}var n;this.toggle=function(t){if(t){n||e();var r=$(".ra-pause").offset();r&&(r.left=Math.max(0,r.left+$(".ra-pause").outerWidth()/2-n.outerWidth()/2),r.top+=$(".ra-pause").height()+5,n.css(r).show())}else n&&n.hide()}}var pauseBtn=document.querySelector(".ra-pause");pauseBtn&&(pauseBtn.style.display="none"),"undefined"==typeof Promise&&ajaxGetCb("https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.min.js",eval);var speech,voiceProvider=new VoiceProvider,attribution=new Attribution;this.play=function(e){return ready().then(function(){return speech?speech.play():speak((new HtmlDoc).getTexts(0),e)}).then(updateButtons)},this.speak=function(e,n){return ready().then(speak.bind(this,e,n)).then(updateButtons)},this.pause=function(){return speech?speech.pause().then(updateButtons):Promise.resolve()},this.isPlaying=isPlaying},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,n){"function"==typeof define&&define.amd?define([],function(){return e.annyang=n(e)}):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=n(e):e.annyang=n(e)}("undefined"!=typeof window?window:void 0,function(e,n){var t,r=e.SpeechRecognition||e.webkitSpeechRecognition||e.mozSpeechRecognition||e.msSpeechRecognition||e.oSpeechRecognition;if(!r)return null;var a,o,s=[],i={start:[],error:[],end:[],soundstart:[],result:[],resultMatch:[],resultNoMatch:[],errorNetwork:[],errorPermissionBlocked:[],errorPermissionDenied:[]},c=0,l=0,u=!1,g="font-weight: bold; color: #00f;",d=!1,p=!1,m=/\s*\((.*?)\)\s*/g,f=/(\(\?:[^)]+\))\?/g,h=/(\(\?)?:\w+/g,v=/\*\w+/g,y=/[\-{}\[\]+?.,\\\^$|#]/g,_=function(e){for(var n=arguments.length,t=Array(1<n?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];e.forEach(function(e){e.callback.apply(e.context,t)})},w=function(){return a!==n},b=function(e,n){-1!==e.indexOf("%c")||n?console.log(e,n||g):console.log(e)},S=function(){w()||t.init({},!1)},T=function(e,n,t){s.push({command:e,callback:n,originalPhrase:t}),u&&b("Command successfully loaded: %c"+t,g)},P=function(e){var n;_(i.result,e);for(var t=0;t<e.length;t++){n=e[t].trim(),u&&b("Speech recognized: %c"+n,g);for(var r=0,a=s.length;r<a;r++){var o=s[r],c=o.command.exec(n);if(c){var l=c.slice(1);return u&&(b("command matched: %c"+o.originalPhrase,g),l.length&&b("with parameters",l)),o.callback.apply(this,l),void _(i.resultMatch,n,o.originalPhrase,e)}}}_(i.resultNoMatch,e)};return t={init:function(g){var m=!(1<arguments.length&&arguments[1]!==n)||arguments[1];a&&a.abort&&a.abort(),(a=new r).maxAlternatives=5,a.continuous="http:"===e.location.protocol,a.lang="en-US",a.onstart=function(){p=!0,_(i.start)},a.onsoundstart=function(){_(i.soundstart)},a.onerror=function(e){switch(_(i.error,e),e.error){case"network":_(i.errorNetwork,e);break;case"not-allowed":case"service-not-allowed":o=!1,(new Date).getTime()-c<200?_(i.errorPermissionBlocked,e):_(i.errorPermissionDenied,e)}},a.onend=function(){if(p=!1,_(i.end),o){var e=(new Date).getTime()-c;(l+=1)%10==0&&u&&b("Speech Recognition is repeatedly stopping and starting. See http://is.gd/annyang_restarts for tips."),e<1e3?setTimeout(function(){t.start({paused:d})},1e3-e):t.start({paused:d})}},a.onresult=function(e){if(d)return u&&b("Speech heard, but annyang is paused"),!1;for(var n=e.results[e.resultIndex],t=[],r=0;r<n.length;r++)t[r]=n[r].transcript;P(t)},m&&(s=[]),g.length&&this.addCommands(g)},start:function(e){S(),d=(e=e||{}).paused!==n&&!!e.paused,o=e.autoRestart===n||!!e.autoRestart,e.continuous!==n&&(a.continuous=!!e.continuous),c=(new Date).getTime();try{a.start()}catch(e){u&&b(e.message)}},abort:function(){o=!1,l=0,w()&&a.abort()},pause:function(){d=!0},resume:function(){t.start()},debug:function(){var e=!(0<arguments.length&&arguments[0]!==n)||arguments[0];u=!!e},setLanguage:function(e){S(),a.lang=e},addCommands:function(n){var t,r;for(var a in S(),n)if(n.hasOwnProperty(a))if("function"==typeof(t=e[n[a]]||n[a]))T((r=(r=a).replace(y,"\\$&").replace(m,"(?:$1)?").replace(h,function(e,n){return n?e:"([^\\s]+)"}).replace(v,"(.*?)").replace(f,"\\s*$1?\\s*"),new RegExp("^"+r+"$","i")),t,a);else{if(!("object"===(void 0===t?"undefined":_typeof(t))&&t.regexp instanceof RegExp)){u&&b("Can not register command: %c"+a,g);continue}T(new RegExp(t.regexp.source,"i"),t.callback,a)}},removeCommands:function(e){e===n?s=[]:(e=Array.isArray(e)?e:[e],s=s.filter(function(n){for(var t=0;t<e.length;t++)if(e[t]===n.originalPhrase)return!1;return!0}))},addCallback:function(t,r,a){var o=e[r]||r;"function"==typeof o&&i[t]!==n&&i[t].push({callback:o,context:a||this})},removeCallback:function(e,t){var r=function(e){return e.callback!==t};for(var a in i)i.hasOwnProperty(a)&&(e!==n&&e!==a||(i[a]=t===n?[]:i[a].filter(r)))},isListening:function(){return p&&!d},getSpeechRecognizer:function(){return a},trigger:function(e){t.isListening()?(Array.isArray(e)||(e=[e]),P(e)):u&&b(p?"Speech heard, but annyang is paused":"Cannot trigger while annyang is aborted")}}}),annyang&&(navigator.mediaDevices.getUserMedia({audio:!0}),annyang.isListening()||chrome.tabs.create({url:chrome.extension.getURL("options.html"),selected:!0}));var page_contents={sideBarContent:{tags:["aside"],value:new Set,class:["nav","breadcrumb-item","tab-content","page-link","navigation"]},navigationContent:{tags:["a"],value:new Set,class:[]},headers:{tags:["h1","h2","h3","h4","h5","h6"],value:new Set,class:[]},paragraphContent:{tags:["p"],value:new Set,class:["content","main"]},lists:{tags:["li"],value:new Set,class:["list-group-item"]},tableContent:{tags:["th","td"],value:new Set,class:[]},imageAlt:{tags:[],value:new Set,class:[]},blockQuotes:{tags:[],value:new Set,class:["blockquote"]},footers:{tags:["footer"],value:new Set,class:["footer"]},buttons:{tags:["button"],value:new Set,class:["button","btn"]},cards:{tags:["card"],value:new Set,class:["card","cards"]},carouselContent:{tags:[],value:new Set,class:["carousel-caption","carousel"]}};for(var key in page_contents){for(var i=0;i<page_contents[key].tags.length;++i)for(var content=addToContent(page_contents[key].tags[i]),count=content.length,j=0;j<count;j++)page_contents[key].value.add(content[j]);for(var i=0;i<page_contents[key].class.length;++i)for(var content=addToContent(page_contents[key].class[i]),count=content.length,j=0;j<count;j++)page_contents[key].value.add(content[j])}for(var count=document.getElementsByTagName("img").length,i=0;i<count;i++)page_contents.imageAlt.value+=document.getElementsByTagName("img")[i].getAttribute("alt")+" ";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,n){"function"==typeof define&&define.amd?define([],function(){return e.annyang=n(e)}):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=n(e):e.annyang=n(e)}("undefined"!=typeof window?window:void 0,function(e,n){var t,r=e.SpeechRecognition||e.webkitSpeechRecognition||e.mozSpeechRecognition||e.msSpeechRecognition||e.oSpeechRecognition;if(!r)return null;var a,o,s=[],i={start:[],error:[],end:[],soundstart:[],result:[],resultMatch:[],resultNoMatch:[],errorNetwork:[],errorPermissionBlocked:[],errorPermissionDenied:[]},c=0,l=0,u=!1,g="font-weight: bold; color: #00f;",d=!1,p=!1,m=/\s*\((.*?)\)\s*/g,f=/(\(\?:[^)]+\))\?/g,h=/(\(\?)?:\w+/g,v=/\*\w+/g,y=/[\-{}\[\]+?.,\\\^$|#]/g,_=function(e){for(var n=arguments.length,t=Array(1<n?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];e.forEach(function(e){e.callback.apply(e.context,t)})},w=function(){return a!==n},b=function(e,n){-1!==e.indexOf("%c")||n?console.log(e,n||g):console.log(e)},S=function(){w()||t.init({},!1)},T=function(e,n,t){s.push({command:e,callback:n,originalPhrase:t}),u&&b("Command successfully loaded: %c"+t,g)},P=function(e){var n;_(i.result,e);for(var t=0;t<e.length;t++){n=e[t].trim(),u&&b("Speech recognized: %c"+n,g);for(var r=0,a=s.length;r<a;r++){var o=s[r],c=o.command.exec(n);if(c){var l=c.slice(1);return u&&(b("command matched: %c"+o.originalPhrase,g),l.length&&b("with parameters",l)),o.callback.apply(this,l),void _(i.resultMatch,n,o.originalPhrase,e)}}}_(i.resultNoMatch,e)};return t={init:function(g){var m=!(1<arguments.length&&arguments[1]!==n)||arguments[1];a&&a.abort&&a.abort(),(a=new r).maxAlternatives=5,a.continuous="http:"===e.location.protocol,a.lang="en-US",a.onstart=function(){p=!0,_(i.start)},a.onsoundstart=function(){_(i.soundstart)},a.onerror=function(e){switch(_(i.error,e),e.error){case"network":_(i.errorNetwork,e);break;case"not-allowed":case"service-not-allowed":o=!1,(new Date).getTime()-c<200?_(i.errorPermissionBlocked,e):_(i.errorPermissionDenied,e)}},a.onend=function(){if(p=!1,_(i.end),o){var e=(new Date).getTime()-c;(l+=1)%10==0&&u&&b("Speech Recognition is repeatedly stopping and starting. See http://is.gd/annyang_restarts for tips."),e<1e3?setTimeout(function(){t.start({paused:d})},1e3-e):t.start({paused:d})}},a.onresult=function(e){if(d)return u&&b("Speech heard, but annyang is paused"),!1;for(var n=e.results[e.resultIndex],t=[],r=0;r<n.length;r++)t[r]=n[r].transcript;P(t)},m&&(s=[]),g.length&&this.addCommands(g)},start:function(e){S(),d=(e=e||{}).paused!==n&&!!e.paused,o=e.autoRestart===n||!!e.autoRestart,e.continuous!==n&&(a.continuous=!!e.continuous),c=(new Date).getTime();try{a.start()}catch(e){u&&b(e.message)}},abort:function(){o=!1,l=0,w()&&a.abort()},pause:function(){d=!0},resume:function(){t.start()},debug:function(){var e=!(0<arguments.length&&arguments[0]!==n)||arguments[0];u=!!e},setLanguage:function(e){S(),a.lang=e},addCommands:function(n){var t,r;for(var a in S(),n)if(n.hasOwnProperty(a))if("function"==typeof(t=e[n[a]]||n[a]))T((r=(r=a).replace(y,"\\$&").replace(m,"(?:$1)?").replace(h,function(e,n){return n?e:"([^\\s]+)"}).replace(v,"(.*?)").replace(f,"\\s*$1?\\s*"),new RegExp("^"+r+"$","i")),t,a);else{if(!("object"===(void 0===t?"undefined":_typeof(t))&&t.regexp instanceof RegExp)){u&&b("Can not register command: %c"+a,g);continue}T(new RegExp(t.regexp.source,"i"),t.callback,a)}},removeCommands:function(e){e===n?s=[]:(e=Array.isArray(e)?e:[e],s=s.filter(function(n){for(var t=0;t<e.length;t++)if(e[t]===n.originalPhrase)return!1;return!0}))},addCallback:function(t,r,a){var o=e[r]||r;"function"==typeof o&&i[t]!==n&&i[t].push({callback:o,context:a||this})},removeCallback:function(e,t){var r=function(e){return e.callback!==t};for(var a in i)i.hasOwnProperty(a)&&(e!==n&&e!==a||(i[a]=t===n?[]:i[a].filter(r)))},isListening:function(){return p&&!d},getSpeechRecognizer:function(){return a},trigger:function(e){t.isListening()?(Array.isArray(e)||(e=[e]),P(e)):u&&b(p?"Speech heard, but annyang is paused":"Cannot trigger while annyang is aborted")}}});var page_contents={sideBarContent:{tags:["aside"],value:new Set,class:["nav","breadcrumb-item","tab-content","page-link","navigation"]},navigationContent:{tags:["a"],value:new Set,class:[]},headers:{tags:["h1","h2","h3","h4","h5","h6"],value:new Set,class:[]},paragraphContent:{tags:["p"],value:new Set,class:["content","main"]},lists:{tags:["li"],value:new Set,class:["list-group-item"]},tableContent:{tags:["th","td"],value:new Set,class:[]},imageAlt:{tags:[],value:new Set,class:[]},blockQuotes:{tags:[],value:new Set,class:["blockquote"]},footers:{tags:["footer"],value:new Set,class:["footer"]},buttons:{tags:["button"],value:new Set,class:["button","btn"]},cards:{tags:["card"],value:new Set,class:["card","cards"]},carouselContent:{tags:[],value:new Set,class:["carousel-caption","carousel"]}};for(var key in page_contents){for(var i=0;i<page_contents[key].tags.length;++i)for(var content=addToContent(page_contents[key].tags[i]),count=content.length,j=0;j<count;j++)page_contents[key].value.add(content[j]);for(var i=0;i<page_contents[key].class.length;++i)for(var content=addToContent(page_contents[key].class[i]),count=content.length,j=0;j<count;j++)page_contents[key].value.add(content[j])}for(var count=document.getElementsByTagName("img").length,i=0;i<count;i++)page_contents.imageAlt.value+=document.getElementsByTagName("img")[i].getAttribute("alt")+" ";if(annyang){var commands={hello:function(){console.log("Hello World!!")},"show me *website":function(e){console.log(e),chrome.tabs.create({url:"https://"+e+".com",selected:!0}),speechWrapper(["Opening..",e])},"bring me to *website":function(e){console.log(e),chrome.tabs.create({url:"https://"+e+".com",selected:!0}),speechWrapper(["Opening..",e])},"take me to *website":function(e){console.log(e),chrome.tabs.create({url:"https://"+e+".com",selected:!0}),speechWrapper(["Opening..",e])},"open *website":function(e){console.log(e),chrome.tabs.create({url:"https://"+e+".com",selected:!0}),speechWrapper(["Opening..",e])},"navigate to *website":function(e){console.log(e),chrome.tabs.create({url:"https://"+e+".com",selected:!0}),speechWrapper(["Opening..",e])},"search *item":function(e){console.log(e),chrome.tabs.create({url:"https://www.google.com/search?q="+e,selected:!0}),speechWrapper(["Searching for..",e])},"read *item":function(e){console.log(e),getBackgroundPage().then(function(e){return e.play(function(e){e&&$("#status").text(e.message).show()}).then(updateButtons).then(e.getDocInfo).then(function(e){return setState("lastUrl",e&&e.url)}).catch(function(n){n.stack&&e.reportIssue(null,n.stack.startsWith(n.name)?n.stack:n.name+": "+n.message+"\n"+n.stack),/^{/.test(n.message)?$("#status").text(formatError(JSON.parse(n.message))||n.message).show():$("#status").text(n.message).show()})}),"content"==e?speechWrapper(Array.from(page_contents.paragraphContent.value)):"navigation"==e?speechWrapper(Array.from(page_contents.navigationContent.value)):"headers"==e?speechWrapper(Array.from(page_contents.headers.value)):"lists"==e?speechWrapper(Array.from(page_contents.lists.value)):"tables"==e?speechWrapper(Array.from(page_contents.tableContent.value)):"images"==e?speechWrapper(Array.from(page_contents.imageAlt.value)):"quotes"==e?speechWrapper(Array.from(page_contents.blockQuotes.value)):"footers"==e?speechWrapper(Array.from(page_contents.footers.value)):"buttons"==e?speechWrapper(Array.from(page_contents.buttons.value)):"cards"==e?speechWrapper(Array.from(page_contents.cards.value)):"carousel"==e?speechWrapper(Array.from(page_contents.carouselContent.value)):"everything"==e&&master.play(function(e){e&&$("#status").text(e.message).show()})}};annyang.addCallback("resultNoMatch",function(e,n,t){console.log(e),console.log(n),console.log(t)}),annyang.addCommands(commands),speechWrapper(["Hi! I am your personal assistant. To get started ask me to do something!"]).then(function(){annyang.start()}),console.log(annyang.isListening())}